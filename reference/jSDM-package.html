<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>joint species distribution models — jSDM-package • jSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="joint species distribution models — jSDM-package"><meta property="og:description" content="jSDM is an R package for fitting joint species distribution models (JSDM) in a hierarchical Bayesian framework.
The Gibbs sampler is written in C++. It uses Rcpp, Armadillo and GSL to maximize computation efficiency.
Package:jSDM
Type:Package
Version:0.1.0
Date:2019-01-11
License:GPL-3
LazyLoad:yes


"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ghislainv/jSDM" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>joint species distribution models</h1>
    <small class="dont-index">Source: <a href="https://github.com/ghislainv/jSDM/blob/HEAD/R/jSDM-package.R" class="external-link"><code>R/jSDM-package.R</code></a></small>
    <div class="hidden name"><code>jSDM-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>jSDM</code> is an R package for fitting joint species distribution models (JSDM) in a hierarchical Bayesian framework.</p>
<p>The Gibbs sampler is written in C++. It uses Rcpp, Armadillo and GSL to maximize computation efficiency.</p><table class="table table"><tr><td>Package:</td><td>jSDM</td></tr><tr><td>Type:</td><td>Package</td></tr><tr><td>Version:</td><td>0.1.0</td></tr><tr><td>Date:</td><td>2019-01-11</td></tr><tr><td>License:</td><td>GPL-3</td></tr><tr><td>LazyLoad:</td><td>yes</td></tr></table></div>


    <div id="details">
    <h2>Details</h2>
    <p>The package includes the following functions to fit various species distribution models :</p>
<table class="table table"><tr><td>function</td><td>data-type</td></tr><tr><td><code><a href="jSDM_binomial_logit.html">jSDM_binomial_logit</a></code></td><td>presence-absence</td></tr><tr><td><code><a href="jSDM_binomial_probit.html">jSDM_binomial_probit</a></code></td><td>presence-absence</td></tr><tr><td><code><a href="jSDM_binomial_probit_sp_constrained.html">jSDM_binomial_probit_sp_constrained</a></code></td><td>presence-absence</td></tr><tr><td><code><a href="jSDM_binomial_probit_long_format.html">jSDM_binomial_probit_long_format</a></code></td><td>presence-absence</td></tr><tr><td><code><a href="jSDM_poisson_log.html">jSDM_poisson_log</a></code></td><td>abundance</td></tr></table><ul><li><p><code><a href="jSDM_binomial_probit.html">jSDM_binomial_probit</a></code> : <br><br><b>Ecological process:</b>
$$y_{ij} \sim \mathcal{B}ernoulli(\theta_{ij})$$
where </p><table class="table table"><tr><td>if <code>n_latent=0</code> and <code>site_effect="none"</code></td><td>probit\((\theta_{ij}) = X_i \beta_j\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="none"</code></td><td>probit\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="fixed"</code></td><td>probit\((\theta_{ij}) =  X_i \beta_j  + \alpha_i\)  and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="fixed"</code></td><td>probit\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j + \alpha_i\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="random"</code></td><td>probit\((\theta_{ij}) =  X_i \beta_j  + \alpha_i\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="random"</code></td><td>probit\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr></table></li>
<li><p><code><a href="jSDM_binomial_probit_sp_constrained.html">jSDM_binomial_probit_sp_constrained</a></code> : <br><br>
This function allows to fit the same models than the function <code><a href="jSDM_binomial_probit.html">jSDM_binomial_probit</a></code> except for models not including latent variables, indeed <code>n_latent</code> must be greater than zero in this function. 
At first, the function fit a JSDM with the constrained species arbitrarily chosen as the first ones in the presence-absence data-set.
Then, the function evaluates the convergence of MCMC \(\lambda\) chains using the Gelman-Rubin convergence diagnostic (\(\hat{R}\)).
It identifies the species (\(\hat{j}_l\)) having the higher \(\hat{R}\) for \(\lambda_{\hat{j}_l}\).
These species drive the structure of the latent axis \(l\).
The \(\lambda\) corresponding to this species are constrained to be positive and placed on the diagonal of the \(\Lambda\) matrix for fitting a second model.
This usually improves the convergence of the latent variables and factor loadings. The function returns the parameter posterior distributions for this second model.</p></li>
<li><p><code><a href="jSDM_binomial_logit.html">jSDM_binomial_logit</a></code> : <br><br><b>Ecological process : </b>
$$y_{ij} \sim \mathcal{B}inomial(\theta_{ij},t_i)$$
where </p><table class="table table"><tr><td>if <code>n_latent=0</code> and <code>site_effect="none"</code></td><td>logit\((\theta_{ij}) =  X_i \beta_j\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="none"</code></td><td>logit\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="fixed"</code></td><td>logit\((\theta_{ij}) =  X_i \beta_j  + \alpha_i\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="fixed"</code></td><td>logit\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j + \alpha_i\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="random"</code></td><td>logit\((\theta_{ij}) =  X_i \beta_j  + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="random"</code></td><td>logit\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr></table></li>
<li><p><code><a href="jSDM_poisson_log.html">jSDM_poisson_log</a></code> : <br><br><b>Ecological process : </b>
$$y_{ij} \sim \mathcal{P}oisson(\theta_{ij})$$
where </p><table class="table table"><tr><td>if <code>n_latent=0</code> and <code>site_effect="none"</code></td><td>log\((\theta_{ij}) =  X_i \beta_j\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="none"</code></td><td>log\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="fixed"</code></td><td>log\((\theta_{ij}) =  X_i \beta_j  + \alpha_i\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="fixed"</code></td><td>log\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j + \alpha_i\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="random"</code></td><td>log\((\theta_{ij}) =  X_i \beta_j  + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="random"</code></td><td>log\((\theta_{ij}) =  X_i \beta_j + W_i \lambda_j + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr></table></li>
<li><p><code><a href="jSDM_binomial_probit_long_format.html">jSDM_binomial_probit_long_format</a></code> : <br><br><b>Ecological process:</b>
$$y_n \sim \mathcal{B}ernoulli(\theta_n)$$ such as \(species_n=j\) and \(site_n=i\),
where </p><table class="table table"><tr><td>if <code>n_latent=0</code> and <code>site_effect="none"</code></td><td>probit\((\theta_n) = D_n \gamma + X_n \beta_j\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="none"</code></td><td>probit\((\theta_n) = D_n \gamma + X_n \beta_j +  W_i \lambda_j\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="fixed"</code></td><td>probit\((\theta_n) = D_n \gamma + X_n \beta_j + \alpha_i\)  and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="fixed"</code></td><td>probit\((\theta_n) = D_n \gamma + X_n  \beta_j +  W_i \lambda_j + \alpha_i\)</td></tr><tr><td>if <code>n_latent=0</code> and <code>site_effect="random"</code></td><td>probit\((\theta_n) = D_n \gamma + X_n \beta_j + \alpha_i\)</td></tr><tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="random"</code></td><td>probit\((\theta_n) = D_n \gamma + X_n  \beta_j +  W_i \lambda_j + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr></table></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Chib, S. and Greenberg, E. (1998) Analysis of multivariate probit models. <em>Biometrika</em>, 85, 347-361.</p>
<p>Warton, D. I.; Blanchet, F. G.; O'Hara, R. B.; O'Hara, R. B.; Ovaskainen, O.; Taskinen, S.; Walker, S. C. and Hui, F. K. C. (2015) So Many Variables: Joint Modeling in Community Ecology. <em>Trends in Ecology &amp; Evolution</em>, 30, 766-779.</p>
<p>Ovaskainen, O., Tikhonov, G., Norberg, A., Blanchet, F. G., Duan, L., Dunson, D., Roslin, T. and Abrego, N. (2017) How to make more out of community data? A conceptual framework and its implementation as models and software. <em>Ecology Letters</em>, 20, 561-576.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ghislain Vieilledent &lt;ghislain.vieilledent@cirad.fr&gt;</p>
<p>Jeanne Clément &lt;jeanne.clement16@laposte.net&gt;</p>
<p>Frédéric Gosselin &lt;frederic.gosselin@inrae.fr&gt;</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeanne Clément, <a href="https://ecology.ghislainv.fr" class="external-link">Ghislain Vieilledent</a>, <a href="https://www.cirad.fr" class="external-link"><img src="https://ecology.ghislainv.fr/images/logos/logo-cirad.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

