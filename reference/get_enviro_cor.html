<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract covariances and correlations due to shared environmental responses — get_enviro_cor • jSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract covariances and correlations due to shared environmental responses — get_enviro_cor"><meta property="og:description" content="Calculates the correlation between columns of the response matrix, due to similarities in the response to explanatory variables i.e., shared environmental response."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ghislainv/jSDM" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract covariances and correlations due to shared environmental responses</h1>
    <small class="dont-index">Source: <a href="https://github.com/ghislainv/jSDM/blob/HEAD/R/get_enviro_cor.R" class="external-link"><code>R/get_enviro_cor.R</code></a></small>
    <div class="hidden name"><code>get_enviro_cor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the correlation between columns of the response matrix, due to similarities in the response to explanatory variables i.e., shared environmental response.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_enviro_cor</span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"mean"</span>, prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mod</dt>
<dd><p>An object of class <code>"jSDM"</code></p></dd>
<dt>type</dt>
<dd><p>A choice of either the posterior median (<code>type = "median"</code>) or posterior mean (<code>type = "mean"</code>), which are then treated as estimates and the fitted values are calculated from.
Default is posterior mean.</p></dd>
<dt>prob</dt>
<dd><p>A numeric scalar in the interval \((0,1)\) giving the target probability coverage of the intervals, by which to determine whether the correlations are "significant".
Defaults to 0.95.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>results A list including :</p>
<dl><dt>cor, cor.lower, cor.upper</dt>
<dd><p>A set of \(np \times np\) correlation matrices, containing either the posterior median or mean estimate  over the MCMC samples plus lower and upper limits of the corresponding 95 % highest posterior interval.</p></dd>
<dt>sig.cor</dt>
<dd><p>A \(np \times np\) correlation matrix containing only the “significant" correlations whose 95 % highest posterior interval does not contain zero. All non-significant correlations are set to zero.</p></dd>
<dt>cov</dt>
<dd><p>Average over the MCMC samples of the \(np \times np\) covariance matrix.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>In both independent response and correlated response models, where the each of the columns of the response matrix y are fitted to a set of explanatory variables given by X,
the covariance and thus between two columns \(j\) and \(j'\) due to similarities in their response to the model matrix is calculated based on the linear predictors \(X \beta_j\) and \(X \beta_j'\), where \(\beta_j\) are species effects relating to the explanatory variables.
Such correlation matrices are discussed and found in Ovaskainen et al., (2010), Pollock et al., 2014</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<table class="table table"><tr><td>Hui FKC (2016). “boral: Bayesian Ordination and Regression Analysis of Multivariate Abundance Data in R.” Methods in Ecology and Evolution, 7, 744–750.</td></tr><tr><td>Ovaskainen et al. (2010). Modeling species co-occurrence by multivariate logistic regression generates new hypotheses on fungal interactions. Ecology, 91, 2514-2521.</td></tr><tr><td>Pollock et al. (2014). Understanding co-occurrence by modelling species simultaneously with a Joint Species Distribution Model (JSDM). Methods in Ecology and Evolution, 5, 397-406.</td></tr><tr><td></td></tr></table></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></code> <code><a href="get_residual_cor.html">get_residual_cor</a></code> <code><a href="jSDM-package.html">jSDM-package</a></code> <code><a href="jSDM_binomial_probit.html">jSDM_binomial_probit</a></code> <code><a href="jSDM_binomial_logit.html">jSDM_binomial_logit</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    
<table class="table table"><tr><td>Ghislain Vieilledent &lt;ghislain.vieilledent@cirad.fr&gt;</td></tr><tr><td>Jeanne Clément &lt;jeanne.clement16@laposte.net&gt;</td></tr><tr><td></td></tr></table></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ecology.ghislainv.fr/jSDM/" class="external-link">jSDM</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># frogs data</span></span>
<span class="r-in"> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">frogs</span>, package<span class="op">=</span><span class="st">"jSDM"</span><span class="op">)</span></span>
<span class="r-in"> <span class="co"># Arranging data</span></span>
<span class="r-in"> <span class="va">PA_frogs</span> <span class="op">&lt;-</span> <span class="va">frogs</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span class="r-in"> <span class="co"># Normalized continuous variables</span></span>
<span class="r-in"> <span class="va">Env_frogs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">frogs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">frogs</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">frogs</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Env_frogs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frogs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">Env_frogs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Env_frogs</span><span class="op">)</span></span>
<span class="r-in"> <span class="co"># Parameter inference</span></span>
<span class="r-in"><span class="co"># Increase the number of iterations to reach MCMC convergence</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="jSDM_binomial_probit.html">jSDM_binomial_probit</a></span><span class="op">(</span><span class="co"># Response variable</span></span>
<span class="r-in">                             presence_data<span class="op">=</span><span class="va">PA_frogs</span>,</span>
<span class="r-in">                             <span class="co"># Explanatory variables</span></span>
<span class="r-in">                             site_formula <span class="op">=</span> <span class="op">~</span><span class="va">.</span>,</span>
<span class="r-in">                             site_data <span class="op">=</span> <span class="va">Env_frogs</span>,</span>
<span class="r-in">                             n_latent<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">                             site_effect<span class="op">=</span><span class="st">"random"</span>,</span>
<span class="r-in">                             <span class="co"># Chains</span></span>
<span class="r-in">                             burnin<span class="op">=</span><span class="fl">100</span>,</span>
<span class="r-in">                             mcmc<span class="op">=</span><span class="fl">100</span>,</span>
<span class="r-in">                             thin<span class="op">=</span><span class="fl">1</span>,</span>
<span class="r-in">                             <span class="co"># Starting values</span></span>
<span class="r-in">                             alpha_start<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">                             beta_start<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">                             V_alpha<span class="op">=</span><span class="fl">1</span>,</span>
<span class="r-in">                             <span class="co"># Priors</span></span>
<span class="r-in">                             shape<span class="op">=</span><span class="fl">0.5</span>, rate<span class="op">=</span><span class="fl">0.0005</span>,</span>
<span class="r-in">                             mu_beta<span class="op">=</span><span class="fl">0</span>, V_beta<span class="op">=</span><span class="fl">10</span>,</span>
<span class="r-in">                             <span class="co"># Various</span></span>
<span class="r-in">                             seed<span class="op">=</span><span class="fl">1234</span>, verbose<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running the Gibbs sampler. It may be long, please keep cool :)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:10.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:20.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:30.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:40.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:50.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:60.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:70.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:80.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:90.0% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********:100.0% </span>
<span class="r-in"><span class="co"># Calcul of residual correlation between species </span></span>
<span class="r-in"> <span class="va">enviro.cors</span> <span class="op">&lt;-</span> <span class="fu">get_enviro_cor</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeanne Clément, <a href="https://ecology.ghislainv.fr" class="external-link">Ghislain Vieilledent</a>, <a href="https://www.cirad.fr" class="external-link"><img src="https://ecology.ghislainv.fr/images/logos/logo-cirad.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

