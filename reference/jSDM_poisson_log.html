<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Poisson regression with log link function — jSDM_poisson_log • jSDM</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Poisson regression with log link function — jSDM_poisson_log" />
<meta property="og:description" content="The jSDM_poisson_log function performs a Poisson regression with log link function in a Bayesian framework. 
The function calls a Gibbs sampler written in C++ code which uses an adaptive Metropolis algorithm to estimate the conditional posterior distribution of model's parameters." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a></a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://twitter.com/ghislainv">
    <span class="fas fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ghislainv/jSDM">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Poisson regression with log link function</h1>
    <small class="dont-index">Source: <a href='https://github.com/ghislainv/jSDM/blob/master/R/jSDM_poisson_log.R'><code>R/jSDM_poisson_log.R</code></a></small>
    <div class="hidden name"><code>jSDM_poisson_log.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>jSDM_poisson_log</code> function performs a Poisson regression with log link function in a Bayesian framework. 
The function calls a Gibbs sampler written in C++ code which uses an adaptive Metropolis algorithm to estimate the conditional posterior distribution of model's parameters.</p>
    </div>

    <pre class="usage"><span class='fu'>jSDM_poisson_log</span><span class='op'>(</span>
  burnin <span class='op'>=</span> <span class='fl'>5000</span>,
  mcmc <span class='op'>=</span> <span class='fl'>10000</span>,
  thin <span class='op'>=</span> <span class='fl'>10</span>,
  <span class='va'>presence_site_sp</span>,
  <span class='va'>site_suitability</span>,
  <span class='va'>site_data</span>,
  n_latent <span class='op'>=</span> <span class='fl'>0</span>,
  site_effect <span class='op'>=</span> <span class='st'>"none"</span>,
  beta_start <span class='op'>=</span> <span class='fl'>0</span>,
  lambda_start <span class='op'>=</span> <span class='fl'>0</span>,
  W_start <span class='op'>=</span> <span class='fl'>0</span>,
  alpha_start <span class='op'>=</span> <span class='fl'>0</span>,
  V_alpha <span class='op'>=</span> <span class='fl'>1</span>,
  shape <span class='op'>=</span> <span class='fl'>0.5</span>,
  rate <span class='op'>=</span> <span class='fl'>5e-04</span>,
  mu_beta <span class='op'>=</span> <span class='fl'>0</span>,
  V_beta <span class='op'>=</span> <span class='fl'>1e+06</span>,
  mu_lambda <span class='op'>=</span> <span class='fl'>0</span>,
  V_lambda <span class='op'>=</span> <span class='fl'>10</span>,
  ropt <span class='op'>=</span> <span class='fl'>0.44</span>,
  seed <span class='op'>=</span> <span class='fl'>1234</span>,
  verbose <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>burnin</th>
      <td><p>The number of burnin iterations for the sampler.</p></td>
    </tr>
    <tr>
      <th>mcmc</th>
      <td><p>The number of Gibbs iterations for the sampler. Total number of Gibbs iterations is equal to <code>burnin+mcmc</code>. <code>burnin+mcmc</code> must be divisible by 10 and superior or equal to 100 so that the progress bar can be displayed.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>The thinning interval used in the simulation. The number of mcmc iterations must be divisible by this value.</p></td>
    </tr>
    <tr>
      <th>presence_site_sp</th>
      <td><p>A vector indicating the number of successes (or presences) and the absence by a zero for each species at studied sites.</p></td>
    </tr>
    <tr>
      <th>site_suitability</th>
      <td><p>A one-sided formula of the form '~x1+...+xp' with p terms specifying the explicative variables for the suitability process of the model.</p></td>
    </tr>
    <tr>
      <th>site_data</th>
      <td><p>data frame containing the model's explicative variables.</p></td>
    </tr>
    <tr>
      <th>n_latent</th>
      <td><p>An integer which specifies the number of latent variables to generate. Defaults to <code>0</code>.</p></td>
    </tr>
    <tr>
      <th>site_effect</th>
      <td><p>A string indicating whether row effects are included as fixed effects (<code>"fixed"</code>), as random effects (<code>"random"</code>), or not included (<code>"none"</code>) in the model. 
If fixed effects, then for parameter identifiability the first row effect is set to zero, which analogous to acting as a reference level when dummy variables are used.
If random effects, they are drawn from a normal distribution with mean zero and unknown variance, analogous to a random intercept in mixed models. Defaults to <code>"none"</code>.</p></td>
    </tr>
    <tr>
      <th>beta_start</th>
      <td><p>Starting values for beta parameters of the suitability process for each species must be either a scalar or a \(p \times n_{species}\) matrix. 
If <code>beta_start</code> takes a scalar value, then that value will serve for all of the \(\beta\) parameters.</p></td>
    </tr>
    <tr>
      <th>lambda_start</th>
      <td><p>Starting values for lambda parameters corresponding to the latent variables for each species must be either a scalar or a \(n_{latent} \times n_{species}\) upper triangular matrix with strictly positive values on the diagonal, ignored if <code>n_latent=0</code>. 
If <code>lambda_start</code> takes a scalar value, then that value will serve for all of the \(\lambda\) parameters except those concerned by the constraints explained above.</p></td>
    </tr>
    <tr>
      <th>W_start</th>
      <td><p>Starting values for latent variables must be either a scalar or a \(nsite \times n_latent\) matrix, ignored if <code>n_latent=0</code>. 
If <code>W_start</code> takes a scalar value, then that value will serve for all of the \(W_{il}\) with \(i=1,\ldots,n_{site}\) and \(l=1,\ldots,n_{latent}\).</p></td>
    </tr>
    <tr>
      <th>alpha_start</th>
      <td><p>Starting values for random site effect parameters must be either a scalar or a nsite-length vector, ignored if <code>site_effect="none"</code>. 
If <code>alpha_start</code> takes a scalar value, then that value will serve for all of the \(\alpha\) parameters.</p></td>
    </tr>
    <tr>
      <th>V_alpha</th>
      <td><p>Starting value for variance of random site effect if <code>site_effect="random"</code> or constant variance of the Normal prior for the fixed site effect if <code>site_effect="fixed"</code>.
Must be a stricly positive scalar, ignored if <code>site_effect="none"</code>.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>Shape parameter of the Inverse-Gamma prior for the random site effect variance <code>V_alpha</code>, ignored if <code>site_effect="none"</code> or <code>site_effect="fixed"</code>. 
Must be a stricly positive scalar. Default to 0.5 for weak informative prior.</p></td>
    </tr>
    <tr>
      <th>rate</th>
      <td><p>Rate parameter of the Inverse-Gamma prior for the random site effect variance <code>V_alpha</code>, ignored if <code>site_effect="none"</code> or <code>site_effect="fixed"</code>.
Must be a stricly positive scalar. Default to 0.0005 for weak informative prior.</p></td>
    </tr>
    <tr>
      <th>mu_beta</th>
      <td><p>Means of the Normal priors for the \(\beta\) parameters of the suitability process. 
<code>mu_beta</code> must be either a scalar or a \(p\)-length vector. 
If <code>mu_beta</code> takes a scalar value, then that value will serve as the prior mean for all of the \(\beta\) parameters. 
The default value is set to 0 for an uninformative prior.</p></td>
    </tr>
    <tr>
      <th>V_beta</th>
      <td><p>Variances of the Normal priors for the \(\beta\) parameters of the suitability process. <code>V_beta</code> must be either a scalar or a \(p\)-length \(n_{latent}\) vector. 
If <code>V_beta</code> takes a scalar value, then that value will serve as the prior variance for all of the \(\beta\) parameters.
The default variance is large and set to 1.0E6 for an uninformative flat prior.</p></td>
    </tr>
    <tr>
      <th>mu_lambda</th>
      <td><p>Means of the Normal priors for the \(\lambda\) parameters corresponding to the latent variables, ignored if <code>n_latent=0</code>. 
<code>mu_lambda</code> must be either a scalar or a \(n_{latent}\)-length vector. If <code>mu_lambda</code> takes a scalar value, then that value will serve as the prior mean for all of the \(\lambda\) parameters.
The default value is set to 0 for an uninformative prior.</p></td>
    </tr>
    <tr>
      <th>V_lambda</th>
      <td><p>Variances of the Normal priors for the \(\lambda\) parameters corresponding to the latent variables, ignored if <code>n_latent=0</code>. 
<code>V_lambda</code> must be either a scalar or a \(n_{latent}\)-length positive vector. 
If <code>V_lambda</code> takes a scalar value, then that value will serve as the prior variance for all of the \(\lambda\) parameters. The default variance is large and set to 10 for an uninformative flat prior.</p></td>
    </tr>
    <tr>
      <th>ropt</th>
      <td><p>Target acceptance rate for the adaptive Metropolis algorithm. Default to 0.44.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>The seed for the random number generator. Default to 1234.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A switch (0,1) which determines whether or not the progress of the sampler is printed to the screen. Default is 1: a progress bar is printed, indicating the step (in %) reached by the Gibbs sampler.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"jSDM"</code> acting like a list including :</p><table class='table'>
<tr><td>mcmc.alpha</td><td>An mcmc object that contains the posterior samples for site effects \(\alpha_i\), not returned if <code>site_effect="none"</code>.</td></tr>
<tr><td>mcmc.V_alpha</td><td>An mcmc object that contains the posterior samples for variance of random site effect, not returned if <code>site_effect="none"</code> or  <code>site_effect="fixed"</code>.</td></tr>
<tr><td>mcmc.latent</td><td>A list by latent variable of mcmc objects that contains the posterior samples for latent variables \(W_l\) with \(l=1,\ldots,n_{latent}\), not returned if <code>n_latent=0</code>.</td></tr>
<tr><td>mcmc.sp</td><td>A list by species of mcmc objects that contains the posterior samples for species effects \(\beta_j\) and \(\lambda_j\) if <code>n_latent&gt;0</code>.</td></tr>
<tr><td>mcmc.Deviance</td><td>The posterior sample of the deviance \(D\), with \(D=-2\log(\prod_{ij} P(y_{ij}|\beta_j,\lambda_j, \alpha_i, W_i))\), is also provided.</td></tr>
<tr><td>theta_latent</td><td>Predictive posterior mean of the probability associated to the suitability process for each observation.</td></tr>
<tr><td>model_spec</td><td>Various attributes of the model fitted, including the response and model matrix used, distributional assumptions as link function, family and number of latent variables, hyperparameters used in the Bayesian estimation and mcmc, burnin and thin.</td></tr>
</table>
<p>The <code>mcmc.</code> objects can be summarized by functions provided by the <code>coda</code> package.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>We model an ecological process where the presence or absence of species \(j\) on site \(i\) is explained by habitat suitability.</p>
<p><b>Ecological process : </b>
$$y_{ij} \sim \mathcal{P}oisson(\theta_{ij})$$
where</p><table class='table'>
<tr><td>if <code>n_latent=0</code> and <code>site_effect="none"</code></td><td>log\((\theta_{ij}) = \beta_{0j} + X_i \beta_j\)</td></tr>
<tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="none"</code></td><td>log\((\theta_{ij}) = \beta_{0j} + X_i \beta_j + W_i \lambda_j\)</td></tr>
<tr><td>if <code>n_latent=0</code> and <code>site_effect="fixed"</code></td><td>log\((\theta_{ij}) = \beta_{0j} + X_i \beta_j  + \alpha_i\)</td></tr>
<tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="fixed"</code></td><td>log\((\theta_{ij}) = \beta_{0j} + X_i \beta_j + W_i \lambda_j + \alpha_i\)</td></tr>
<tr><td>if <code>n_latent=0</code> and <code>site_effect="random"</code></td><td>log\((\theta_{ij}) = \beta_{0j} + X_i \beta_j  + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr>
<tr><td>if <code>n_latent&gt;0</code> and <code>site_effect="random"</code></td><td>log\((\theta_{ij}) = \beta_{0j} + X_i \beta_j + W_i \lambda_j + \alpha_i\) and \(\alpha_i \sim \mathcal{N}(0,V_\alpha)\)</td></tr>
</table>


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<table class='table'>
<tr><td>Gelfand, A. E.; Schmidt, A. M.; Wu, S.; Silander, J. A.; Latimer, A. and Rebelo, A. G. (2005) Modelling species diversity through species level hierarchical modelling. <em>Applied Statistics</em>, 54, 1-20.</td></tr>
<tr><td>Latimer, A. M.; Wu, S. S.; Gelfand, A. E. and Silander, J. A. (2006) Building statistical models to analyze species distributions. <em>Ecological Applications</em>, 16, 33-50.</td></tr>
<tr><td></td></tr>
</table>


    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/coda/man/plot.mcmc.html'>plot.mcmc</a></code>, <code><a href='https://rdrr.io/pkg/coda/man/summary.mcmc.html'>summary.mcmc</a></code> <code><a href='jSDM_binomial_probit_block.html'>jSDM_binomial_probit_block</a></code>  <code><a href='jSDM_binomial_logit.html'>jSDM_binomial_logit</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    
<table class='table'>
<tr><td>Ghislain Vieilledent &lt;ghislain.vieilledent@cirad.fr&gt;</td></tr>
<tr><td>Jeanne Clément &lt;jeanne.clement16@laposte.net&gt;</td></tr>
<tr><td></td></tr>
</table>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#==============================================</span>
<span class='co'># jSDM_poisson_log ()</span>
<span class='co'># Example with simulated data</span>
<span class='co'>#==============================================</span>

<span class='co'>#=================</span>
<span class='co'>#== Load libraries</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ecology.ghislainv.fr/jSDM'>jSDM</a></span><span class='op'>)</span>

<span class='co'>#==================</span>
<span class='co'>#== Data simulation</span>

<span class='co'>#= Number of sites</span>
<span class='va'>nsite</span> <span class='op'>&lt;-</span> <span class='fl'>60</span>
<span class='co'>#= Number of species</span>
<span class='va'>nsp</span> <span class='op'>&lt;-</span> <span class='fl'>20</span>
<span class='co'>#= Set seed for repeatability</span>
<span class='va'>seed</span> <span class='op'>&lt;-</span> <span class='fl'>1234</span>

<span class='co'>#= Ecological process (suitability)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='va'>seed</span><span class='op'>)</span>
<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>seed</span><span class='op'>)</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='va'>nsite</span><span class='op'>)</span>,<span class='va'>x1</span>,<span class='va'>x2</span><span class='op'>)</span>
<span class='va'>np</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>*</span><span class='va'>seed</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>n_latent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>W</span><span class='op'>)</span>
<span class='va'>l.zero</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>l.diag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='va'>l.other</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>nsp</span><span class='op'>*</span><span class='fl'>2</span><span class='op'>-</span><span class='fl'>3</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='va'>lambda.target</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>l.diag</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,<span class='va'>l.zero</span>,<span class='va'>l.other</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
                          <span class='va'>l.diag</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,<span class='va'>l.other</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>,
                        byrow<span class='op'>=</span><span class='cn'>TRUE</span>, nrow<span class='op'>=</span><span class='va'>nsp</span><span class='op'>)</span>
<span class='va'>beta.target</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>nsp</span><span class='op'>*</span><span class='va'>np</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span>, nrow<span class='op'>=</span><span class='va'>nsp</span><span class='op'>)</span>
<span class='va'>V_alpha.target</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>alpha.target</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nsite</span>,<span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>V_alpha.target</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>log.theta</span> <span class='op'>&lt;-</span> <span class='va'>X</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>beta.target</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>W</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>lambda.target</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>alpha.target</span>
<span class='va'>theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>log.theta</span><span class='op'>)</span>
<span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fl'>2</span>, <span class='va'>rpois</span>, n<span class='op'>=</span><span class='va'>nsite</span><span class='op'>)</span>

<span class='co'>#= Site-occupancy model</span>
<span class='co'># Increase number of iterations (burnin and mcmc) to get convergence</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'>jSDM_poisson_log</span><span class='op'>(</span><span class='co'># Chains</span>
                        burnin<span class='op'>=</span><span class='fl'>200</span>,
                        mcmc<span class='op'>=</span><span class='fl'>200</span>,
                        thin<span class='op'>=</span><span class='fl'>1</span>,
                        <span class='co'># Response variable</span>
                        presence_site_sp<span class='op'>=</span><span class='va'>Y</span>,
                        <span class='co'># Explanatory variables</span>
                        site_suitability<span class='op'>=</span><span class='op'>~</span><span class='va'>x1</span><span class='op'>+</span><span class='va'>x2</span>,
                        site_data<span class='op'>=</span><span class='va'>X</span>,
                        n_latent<span class='op'>=</span><span class='va'>n_latent</span>,
                        site_effect<span class='op'>=</span><span class='st'>"random"</span>,
                        <span class='co'># Starting values</span>
                        beta_start<span class='op'>=</span><span class='fl'>0</span>,
                        lambda_start<span class='op'>=</span><span class='fl'>0</span>,
                        W_start<span class='op'>=</span><span class='fl'>0</span>,
                        alpha_start<span class='op'>=</span><span class='fl'>0</span>,
                        V_alpha<span class='op'>=</span><span class='fl'>1</span>,
                        <span class='co'># Priors</span>
                        shape<span class='op'>=</span><span class='fl'>0.5</span>,
                        rate<span class='op'>=</span><span class='fl'>0.0005</span>,
                        mu_beta<span class='op'>=</span><span class='fl'>0</span>,
                        V_beta<span class='op'>=</span><span class='fl'>10</span>,
                        mu_lambda<span class='op'>=</span><span class='fl'>0</span>,
                        V_lambda<span class='op'>=</span><span class='fl'>10</span>,
                        <span class='co'># Various</span>
                        seed<span class='op'>=</span><span class='fl'>1234</span>,
                        ropt<span class='op'>=</span><span class='fl'>0.44</span>,
                        verbose<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Running the Gibbs sampler. It may be long, please keep cool :)
#&gt; 
#&gt; **********:10.0%, mean accept. rates= beta:0.152 lambda:0.136 W:0.329 alpha:0.217
#&gt; **********:20.0%, mean accept. rates= beta:0.184 lambda:0.178 W:0.334 alpha:0.268
#&gt; **********:30.0%, mean accept. rates= beta:0.275 lambda:0.259 W:0.352 alpha:0.352
#&gt; **********:40.0%, mean accept. rates= beta:0.342 lambda:0.346 W:0.401 alpha:0.397
#&gt; **********:50.0%, mean accept. rates= beta:0.398 lambda:0.408 W:0.422 alpha:0.409
#&gt; **********:60.0%, mean accept. rates= beta:0.428 lambda:0.415 W:0.443 alpha:0.447
#&gt; **********:70.0%, mean accept. rates= beta:0.444 lambda:0.432 W:0.459 alpha:0.455
#&gt; **********:80.0%, mean accept. rates= beta:0.425 lambda:0.417 W:0.434 alpha:0.445
#&gt; **********:90.0%, mean accept. rates= beta:0.437 lambda:0.438 W:0.440 alpha:0.444
#&gt; **********:100.0%, mean accept. rates= beta:0.435 lambda:0.446 W:0.420 alpha:0.440</div><div class='input'><span class='co'>#' #==========</span>
<span class='co'>#' #== Outputs</span>

<span class='co'>#= Parameter estimates</span>

<span class='co'>## beta_j</span>
<span class='co'># summary(mod$mcmc.sp$sp_1[,1:ncol(X)])</span>
<span class='va'>mean_beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>nsp</span>,<span class='va'>np</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"Posteriors_beta_jSDM_log.pdf"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>nsp</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mean_beta</span><span class='op'>[</span><span class='va'>j</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>]</span>,
                         <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/traceplot.html'>traceplot</a></span><span class='op'>(</span><span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.html'>as.mcmc</a></span><span class='op'>(</span>
      <span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='va'>p</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/densplot.html'>densplot</a></span><span class='op'>(</span><span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.html'>as.mcmc</a></span><span class='op'>(</span>
      <span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='va'>p</span><span class='op'>]</span><span class='op'>)</span>,
      main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span>
        <span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='va'>p</span><span class='op'>]</span>,
        <span class='st'>", species : "</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>beta.target</span><span class='op'>[</span><span class='va'>j</span>,<span class='va'>p</span><span class='op'>]</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; agg_png 
#&gt;       2 </div><div class='input'>
<span class='co'>## lambda_j</span>
<span class='co'># summary(mod$mcmc.sp$sp_1[,(ncol(X)+1):(ncol(X)+n_latent)])</span>
<span class='co'># summary(mod$mcmc.sp$sp_2[,(ncol(X)+1):(ncol(X)+n_latent)])</span>
<span class='va'>mean_lambda</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>nsp</span>,<span class='va'>n_latent</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"Posteriors_lambda_jSDM_log.pdf"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>n_latent</span><span class='op'>*</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>nsp</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mean_lambda</span><span class='op'>[</span><span class='va'>j</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span>
                           <span class='op'>[</span>,<span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>+</span><span class='va'>n_latent</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>l</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>n_latent</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/traceplot.html'>traceplot</a></span><span class='op'>(</span><span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.html'>as.mcmc</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span>
                                  <span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>+</span><span class='va'>l</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/densplot.html'>densplot</a></span><span class='op'>(</span><span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.html'>as.mcmc</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span>
                                 <span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>+</span><span class='va'>l</span><span class='op'>]</span><span class='op'>)</span>,
                   main<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.sp</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sp_"</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
                              <span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>+</span><span class='va'>l</span><span class='op'>]</span>,<span class='st'>", species : "</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>lambda.target</span><span class='op'>[</span><span class='va'>j</span>,<span class='va'>l</span><span class='op'>]</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; agg_png 
#&gt;       2 </div><div class='input'>
<span class='co'># Species effects beta and factor loadings lambda</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>beta.target</span>, <span class='va'>mean_beta</span>,
     main<span class='op'>=</span><span class='st'>"species effect beta"</span>,
     xlab <span class='op'>=</span><span class='st'>"obs"</span>, ylab <span class='op'>=</span><span class='st'>"fitted"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span>,b<span class='op'>=</span><span class='fl'>1</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lambda.target</span>, <span class='va'>mean_lambda</span>,
     main<span class='op'>=</span><span class='st'>"factor loadings lambda"</span>,
     xlab <span class='op'>=</span><span class='st'>"obs"</span>, ylab <span class='op'>=</span><span class='st'>"fitted"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span>,b<span class='op'>=</span><span class='fl'>1</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
</div><div class='img'><img src='jSDM_poisson_log-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## W latent variables</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>l</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>n_latent</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>W</span><span class='op'>[</span>,<span class='va'>l</span><span class='op'>]</span>,
       <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.latent</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"lv_"</span>,<span class='va'>l</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='st'>"Mean"</span><span class='op'>]</span>,
       main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Latent variable W_"</span>, <span class='va'>l</span><span class='op'>)</span>,
       xlab <span class='op'>=</span><span class='st'>"obs"</span>, ylab <span class='op'>=</span><span class='st'>"fitted"</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span>,b<span class='op'>=</span><span class='fl'>1</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='jSDM_poisson_log-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## alpha</span>
<span class='co'># summary(mod$mcmc.alpha)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>alpha.target</span>, <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.alpha</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span>,<span class='st'>"Mean"</span><span class='op'>]</span>,
     xlab <span class='op'>=</span><span class='st'>"obs"</span>, ylab <span class='op'>=</span><span class='st'>"fitted"</span>, main<span class='op'>=</span><span class='st'>"site effect alpha"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span>,b<span class='op'>=</span><span class='fl'>1</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
<span class='co'>## Valpha</span>
<span class='co'># summary(mod$mcmc.V_alpha)</span>
<span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/traceplot.html'>traceplot</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.V_alpha</span><span class='op'>)</span>
<span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/densplot.html'>densplot</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.V_alpha</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>V_alpha.target</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
</div><div class='img'><img src='jSDM_poisson_log-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Deviance</span>
<span class='co'># summary(mod$mcmc.Deviance)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>mcmc.Deviance</span><span class='op'>)</span>
</div><div class='img'><img src='jSDM_poisson_log-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#= Predictions</span>
<span class='co'># summary(mod$theta_latent)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>log.theta</span>, <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>$</span><span class='va'>theta_latent</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>,<span class='va'>log</span><span class='op'>)</span>,
     main<span class='op'>=</span><span class='st'>"log(theta)"</span>,
     xlab<span class='op'>=</span><span class='st'>"obs"</span>, ylab<span class='op'>=</span><span class='st'>"fitted"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span> ,b<span class='op'>=</span><span class='fl'>1</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>mod</span><span class='op'>$</span><span class='va'>theta_latent</span>,
     main<span class='op'>=</span><span class='st'>"Expected abundance theta"</span>,
     xlab<span class='op'>=</span><span class='st'>"obs"</span>, ylab<span class='op'>=</span><span class='st'>"fitted"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span> ,b<span class='op'>=</span><span class='fl'>1</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='jSDM_poisson_log-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jeanne Clément, <a href='https://ecology.ghislainv.fr'>Ghislain Vieilledent</a>, <a href='https://www.cirad.fr'><img src='https://ecology.ghislainv.fr/images/logos/logo-cirad.svg' height=24></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


